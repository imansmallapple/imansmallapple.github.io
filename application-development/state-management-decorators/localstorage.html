<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav ul li a { background-image: none; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>LocalStorage | Oniro</title> <meta name="generator" content="Jekyll v4.3.3" /> <meta property="og:title" content="LocalStorage" /> <meta property="og:locale" content="en_US" /> <meta property="og:site_name" content="Oniro" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="LocalStorage" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","headline":"LocalStorage","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/introduction-to-oniro/images/ONIRO-Masterbrand-horizontal.png"}},"url":"/application-development/state-management-decorators/localstorage.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> <div class="site-logo" role="img" aria-label="Oniro"></div> </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Eclipse Oniro Project category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/" class="nav-list-link">Eclipse Oniro Project</a><ul class="nav-list"><li class="nav-list-item"><a href="/introduction-to-oniro/introduction-to-oniro.html" class="nav-list-link">Introduction to Oniro</a></li><li class="nav-list-item"><a href="/introduction-to-oniro/oniro-architecture.html" class="nav-list-link">Oniro Architecture</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Application Development category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/application-development/" class="nav-list-link">Application Development</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Environment Setup Guide category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/application-development/environment-setup-config/" class="nav-list-link">Environment Setup Guide</a><ul class="nav-list"><li class="nav-list-item"> <a href="/application-development/environment-setup-config/system-requirement.html" class="nav-list-link">System Requirement</a> </li><li class="nav-list-item"> <a href="/application-development/environment-setup-config/ide-installation.html" class="nav-list-link">IDE Installation</a> </li><li class="nav-list-item"> <a href="/application-development/environment-setup-config/env-config.html" class="nav-list-link">Environment Configuration</a> </li><li class="nav-list-item"> <a href="/application-development/environment-setup-config/full-public-sdk.html" class="nav-list-link">Full SDK & Public SDK</a> </li><li class="nav-list-item"> <a href="/application-development/environment-setup-config/developer-account.html" class="nav-list-link">Developer Account</a> </li><li class="nav-list-item"> <a href="/application-development/environment-setup-config/ohpm.html" class="nav-list-link">Introduction to OHPM</a> </li><li class="nav-list-item"> <a href="/application-development/environment-setup-config/common-issue.html" class="nav-list-link">Common Issues and Solutions</a> </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Create Your First Eclipse Oniro Application category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/application-development/create-first-eclipse-oniro-app/" class="nav-list-link">Create Your First Eclipse Oniro Application</a><ul class="nav-list"><li class="nav-list-item"> <a href="/application-development/create-first-eclipse-oniro-app/create-template.html" class="nav-list-link">Create an Eclipse Oniro app using OpenHarmony Template</a> </li><li class="nav-list-item"> <a href="/application-development/create-first-eclipse-oniro-app/find-project-files.html" class="nav-list-link">Find project files</a> </li><li class="nav-list-item"> <a href="/application-development/create-first-eclipse-oniro-app/use-previewer.html" class="nav-list-link">Usage of Previewer</a> </li><li class="nav-list-item"> <a href="/application-development/create-first-eclipse-oniro-app/build-first-page.html" class="nav-list-link">Build the First Page</a> </li><li class="nav-list-item"> <a href="/application-development/create-first-eclipse-oniro-app/build-second-page.html" class="nav-list-link">Build the Second Page</a> </li><li class="nav-list-item"> <a href="/application-development/create-first-eclipse-oniro-app/page-redirect.html" class="nav-list-link">Implementing Page Redirection</a> </li><li class="nav-list-item"> <a href="/application-development/create-first-eclipse-oniro-app/run-real-device.html" class="nav-list-link">Running the Application on a Real Device</a> </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Basic Concepts category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/application-development/basic-concepts/" class="nav-list-link">Basic Concepts</a><ul class="nav-list"><li class="nav-list-item"> <a href="/application-development/basic-concepts/app-pack-structure.html" class="nav-list-link">Application Package Structure in Stage Model</a> </li><li class="nav-list-item"> <a href="/application-development/basic-concepts/introduction-to-arkts.html" class="nav-list-link">Introduction to ArkTS</a> </li><li class="nav-list-item"> <a href="/application-development/basic-concepts/arkui-introduction.html" class="nav-list-link">Introduction to ArkUI</a> </li><li class="nav-list-item"> <a href="/application-development/basic-concepts/uiability-and-component.html" class="nav-list-link">UIAbility and Component</a> </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Resource Categories and Access category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/application-development/resource-categories-and-access/" class="nav-list-link">Resource Categories and Access</a><ul class="nav-list"></ul></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Device Development category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/device-development/" class="nav-list-link">Device Development</a><ul class="nav-list"><li class="nav-list-item"><a href="/device-development/quick-build-with-oniro.html" class="nav-list-link">Building Oniro</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Oniro IDE category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/device-development/oniro-ide/" class="nav-list-link">Oniro IDE</a><ul class="nav-list"><li class="nav-list-item"> <a href="/device-development/oniro-ide/getting-started.html" class="nav-list-link">Getting Started</a> </li><li class="nav-list-item"> <a href="/device-development/oniro-ide/code-editing.html" class="nav-list-link">Code Editing</a> </li><li class="nav-list-item"> <a href="/device-development/oniro-ide/user-interface.html" class="nav-list-link">User Interface</a> </li><li class="nav-list-item"> <a href="/device-development/oniro-ide/code-navigation.html" class="nav-list-link">Code Navigation</a> </li><li class="nav-list-item"> <a href="/device-development/oniro-ide/refacting.html" class="nav-list-link">Refactoring</a> </li><li class="nav-list-item"> <a href="/device-development/oniro-ide/language-support.html" class="nav-list-link">Language Support</a> </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Supported Devices category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/device-development/supported-device/" class="nav-list-link">Supported Devices</a><ul class="nav-list"><li class="nav-list-item"> <a href="/device-development/supported-device/boards/" class="nav-list-link">boards</a> </li><li class="nav-list-item"> <a href="/device-development/supported-device/virtual-machine/" class="nav-list-link">virtual machine</a> </li></ul></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Policies and Compliance category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/policies-and-compliance/" class="nav-list-link">Policies and Compliance</a><ul class="nav-list"></ul></li><li class="nav-list-item"><a href="/community/" class="nav-list-link">Community</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Oniro" aria-label="Search Oniro" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="">Introduction to ArkTS</a></li> <li class="breadcrumb-nav-list-item"><span>LocalStorage</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 id="localstorage-ui-state-storage"> <a href="#localstorage-ui-state-storage" class="anchor-heading" aria-labelledby="localstorage-ui-state-storage"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> LocalStorage: UI State Storage </h1> <p>LocalStorage provides storage for the page-level UI state. The parameters of the LocalStorage type accepted through the @Entry decorator share the same LocalStorage instance on the page. LocalStorage also allows for state sharing between pages with UIAbility instances.</p> <p>This topic describes only the LocalStorage application scenarios and related decorators: <strong>@LocalStorageProp</strong> and <strong>@LocalStorageLink</strong>.</p> <blockquote> <p><strong>NOTE</strong></p> <p>LocalStorage is supported since API version 9.</p> </blockquote> <h2 id="overview"> <a href="#overview" class="anchor-heading" aria-labelledby="overview"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Overview </h2> <p>LocalStorage is an in-memory “database” that ArkTS provides for storing state variables required to build pages of the application UI.</p> <ul> <li> <p>An application can create multiple LocalStorage instances. These instances can be shared on a page or, by using the <strong>GetShared</strong> API, across pages in a UIAbility instance.</p> </li> <li> <p>The root node of a component tree, that is, the @Component decorated by @Entry, can be assigned to a LocalStorage instance. All child instances of this custom component automatically gain access to the same LocalStorage instance.</p> </li> <li> <p>An @Component decorated component has access to at most one LocalStorage instance and to <code class="language-plaintext highlighter-rouge">AppStorage</code>. A component not decorated with @Entry cannot be assigned a LocalStorage instance. It can only accept a LocalStorage instance passed from its parent component through @Entry. A LocalStorage instance can be assigned to multiple components in the component tree.</p> </li> <li> <p>All attributes in LocalStorage are mutable.</p> </li> </ul> <p>The application determines the lifecycle of a LocalStorage object. The JS Engine will garbage collect a LocalStorage object when the application releases the last reference to it, which includes deleting the last custom component.</p> <p>LocalStorage provides two decorators based on the synchronization type of the component decorated with @Component:</p> <ul> <li> <p><a href="#localstorageprop">@LocalStorageProp</a>: creates a one-way data synchronization with the named attribute in LocalStorage.</p> </li> <li> <p><a href="#localstoragelink">@LocalStorageLink</a>: creates a two-way data synchronization with the named attribute in LocalStorage.</p> </li> </ul> <h2 id="localstorageprop"> <a href="#localstorageprop" class="anchor-heading" aria-labelledby="localstorageprop"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> @LocalStorageProp </h2> <p>As mentioned above, if you want to establish a binding between LocalStorage and a custom component, you need to use the @LocalStorageProp and @LocalStorageLink decorators. Specially, use @LocalStorageProp(key) or @LocalStorageLink(key) to decorate variables in the component, where <strong>key</strong> identifies the attribute in LocalStorage.</p> <p>When a custom component is initialized, the @LocalStorageProp(key)/@LocalStorageLink(key) decorated variable is initialized with the value of the attribute with the given key in LocalStorage. Local initialization is mandatory. If an attribute with the given key is missing from LocalStorage, it will be added with the stated initializing value. (Whether the attribute with the given key exists in LocalStorage depends on the application logic.)</p> <blockquote> <p><strong>NOTE</strong></p> <p>This decorator can be used in ArkTS widgets since API version 9.</p> </blockquote> <p>By decorating a variable with @LocalStorageProp(key), a one-way data synchronization is established from the attribute with the given key in LocalStorage to the variable. This means that, local changes (if any) will not be synchronized to LocalStorage, and an update to the attribute with the given key in LocalStorage – for example, a change made with the **set ** API – will overwrite local changes.</p> <h2 id="localstoragelink"> <a href="#localstoragelink" class="anchor-heading" aria-labelledby="localstoragelink"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> @LocalStorageLink </h2> <p>@LocalStorageLink is required if you need to synchronize the changes of the state variables in a custom component back to LocalStorage.</p> <p>@LocalStorageLink(key) creates a two-way data synchronization with the attribute with the given key in LocalStorage.</p> <ol> <li> <p>If a local change occurs, it is synchronized to LocalStorage.</p> </li> <li> <p>Changes in LocalStorage are synchronized to all attributes with the given key, including one-way bound variables (@LocalStorageProp decorated variables and one-way bound variables created through @Prop) and two-way bound variables (@LocalStorageLink decorated variables and two-way bound variables created through @Link).</p> </li> </ol> <h2 id="use-scenarios"> <a href="#use-scenarios" class="anchor-heading" aria-labelledby="use-scenarios"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Use Scenarios </h2> <h3 id="example-of-using-localstorage-in-application-logic"> <a href="#example-of-using-localstorage-in-application-logic" class="anchor-heading" aria-labelledby="example-of-using-localstorage-in-application-logic"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example of Using LocalStorage in Application Logic </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">para</span><span class="p">:</span> <span class="nb">Record</span><span class="o">&lt;</span><span class="kr">string</span><span class="p">,</span><span class="kr">number</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">{</span> <span class="dl">'</span><span class="s1">PropA</span><span class="dl">'</span><span class="p">:</span> <span class="mi">47</span> <span class="p">};</span>
<span class="kd">let</span> <span class="nx">storage</span><span class="p">:</span> <span class="nx">LocalStorage</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LocalStorage</span><span class="p">(</span><span class="nx">para</span><span class="p">);</span> <span class="c1">// Create an instance and initialize it with the given object.</span>
<span class="kd">let</span> <span class="nx">propA</span><span class="p">:</span> <span class="kr">number</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="o">=</span> <span class="nx">storage</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">PropA</span><span class="dl">'</span><span class="p">)</span> <span class="c1">// propA == 47</span>
<span class="kd">let</span> <span class="nx">link1</span><span class="p">:</span> <span class="nx">SubscribedAbstractProperty</span><span class="o">&lt;</span><span class="kr">number</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">storage</span><span class="p">.</span><span class="nf">link</span><span class="p">(</span><span class="dl">'</span><span class="s1">PropA</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// link1.get() == 47</span>
<span class="kd">let</span> <span class="nx">link2</span><span class="p">:</span> <span class="nx">SubscribedAbstractProperty</span><span class="o">&lt;</span><span class="kr">number</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">storage</span><span class="p">.</span><span class="nf">link</span><span class="p">(</span><span class="dl">'</span><span class="s1">PropA</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// link2.get() == 47</span>
<span class="kd">let</span> <span class="nx">prop</span><span class="p">:</span> <span class="nx">SubscribedAbstractProperty</span><span class="o">&lt;</span><span class="kr">number</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">storage</span><span class="p">.</span><span class="nf">prop</span><span class="p">(</span><span class="dl">'</span><span class="s1">PropA</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// prop.get() == 47</span>
<span class="nx">link1</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="mi">48</span><span class="p">);</span> <span class="c1">// two-way sync: link1.get() == link2.get() == prop.get() == 48</span>
<span class="nx">prop</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="c1">// one-way sync: prop.get() == 1; but link1.get() == link2.get() == 48</span>
<span class="nx">link1</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="mi">49</span><span class="p">);</span> <span class="c1">// two-way sync: link1.get() == link2.get() == prop.get() == 49</span>
</code></pre></div></div> <h3 id="example-for-using-localstorage-inside-the-ui"> <a href="#example-for-using-localstorage-inside-the-ui" class="anchor-heading" aria-labelledby="example-for-using-localstorage-inside-the-ui"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example for Using LocalStorage Inside the UI </h3> <p>The two decorators @LocalStorageProp and @LocalStorageLink can work together to obtain the state variable stored in a LocalStorage instance in the UI component.</p> <p>This example uses @LocalStorageLink to show how to:</p> <ul> <li> <p>Use the <strong>build</strong> function to create a LocalStorage instance named <strong>storage</strong>.</p> </li> <li> <p>Use the @Entry decorator to add <strong>storage</strong> to the top-level component <strong>CompA</strong>.</p> </li> <li> <p>Use @LocalStorageLink to create a two-way data synchronization with the given attribute in LocalStorage.</p> </li> </ul> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">PropB</span> <span class="p">{</span>
  <span class="nl">code</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>

  <span class="nf">constructor</span><span class="p">(</span><span class="nx">code</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">code</span> <span class="o">=</span> <span class="nx">code</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="c1">// Create a new instance and initialize it with the given object.</span>
<span class="kd">let</span> <span class="nx">para</span><span class="p">:</span> <span class="nb">Record</span><span class="o">&lt;</span><span class="kr">string</span><span class="p">,</span> <span class="kr">number</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">{</span> <span class="dl">'</span><span class="s1">PropA</span><span class="dl">'</span><span class="p">:</span> <span class="mi">47</span> <span class="p">};</span>
<span class="kd">let</span> <span class="nx">storage</span><span class="p">:</span> <span class="nx">LocalStorage</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LocalStorage</span><span class="p">(</span><span class="nx">para</span><span class="p">);</span>
<span class="nx">storage</span><span class="p">.</span><span class="nf">setOrCreate</span><span class="p">(</span><span class="dl">'</span><span class="s1">PropB</span><span class="dl">'</span><span class="p">,</span> <span class="k">new</span> <span class="nc">PropB</span><span class="p">(</span><span class="mi">50</span><span class="p">));</span>

<span class="p">@</span><span class="nd">Component</span>
<span class="nx">struct</span> <span class="nx">Child</span> <span class="p">{</span>
  <span class="c1">// @LocalStorageLink creates a two-way data synchronization with the PropA attribute in LocalStorage.</span>
  <span class="p">@</span><span class="nd">LocalStorageLink</span><span class="p">(</span><span class="dl">'</span><span class="s1">PropA</span><span class="dl">'</span><span class="p">)</span> <span class="nx">childLinkNumber</span><span class="p">:</span> <span class="kr">number</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="c1">// @LocalStorageLink creates a two-way data synchronization with the PropB attribute in LocalStorage.</span>
  <span class="p">@</span><span class="nd">LocalStorageLink</span><span class="p">(</span><span class="dl">'</span><span class="s1">PropB</span><span class="dl">'</span><span class="p">)</span> <span class="nx">childLinkObject</span><span class="p">:</span> <span class="nx">PropB</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PropB</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

  <span class="nf">build</span><span class="p">()</span> <span class="p">{</span>
    <span class="nc">Column</span><span class="p">()</span> <span class="p">{</span>
      <span class="nc">Button</span><span class="p">(</span><span class="s2">`Child from LocalStorage </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">childLinkNumber</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span> <span class="c1">// The changes will be synchronized to PropA in LocalStorage and with Parent.parentLinkNumber.</span>
        <span class="p">.</span><span class="nf">onClick</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">childLinkNumber</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">})</span>
      <span class="nc">Button</span><span class="p">(</span><span class="s2">`Child from LocalStorage </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">childLinkObject</span><span class="p">.</span><span class="nx">code</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span> <span class="c1">// The changes will be synchronized to PropB in LocalStorage and with Parent.parentLinkObject.code.</span>
        <span class="p">.</span><span class="nf">onClick</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">childLinkObject</span><span class="p">.</span><span class="nx">code</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">})</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="c1">// Make LocalStorage accessible from the @Component decorated component.</span>
<span class="p">@</span><span class="nd">Entry</span><span class="p">(</span><span class="nx">storage</span><span class="p">)</span>
<span class="p">@</span><span class="nd">Component</span>
<span class="nx">struct</span> <span class="nx">CompA</span> <span class="p">{</span>
  <span class="c1">// @LocalStorageLink creates a two-way data synchronization with the PropA attribute in LocalStorage.</span>
  <span class="p">@</span><span class="nd">LocalStorageLink</span><span class="p">(</span><span class="dl">'</span><span class="s1">PropA</span><span class="dl">'</span><span class="p">)</span> <span class="nx">parentLinkNumber</span><span class="p">:</span> <span class="kr">number</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="c1">// @LocalStorageLink creates a two-way data synchronization with the PropB attribute in LocalStorage.</span>
  <span class="p">@</span><span class="nd">LocalStorageLink</span><span class="p">(</span><span class="dl">'</span><span class="s1">PropB</span><span class="dl">'</span><span class="p">)</span> <span class="nx">parentLinkObject</span><span class="p">:</span> <span class="nx">PropB</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PropB</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

  <span class="nf">build</span><span class="p">()</span> <span class="p">{</span>
    <span class="nc">Column</span><span class="p">({</span> <span class="na">space</span><span class="p">:</span> <span class="mi">15</span> <span class="p">})</span> <span class="p">{</span>
      <span class="nc">Button</span><span class="p">(</span><span class="s2">`Parent from LocalStorage </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">parentLinkNumber</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span> <span class="c1">// The initial value from LocalStorage will be 47, because PropA has been initialized.</span>
        <span class="p">.</span><span class="nf">onClick</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">parentLinkNumber</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">})</span>

      <span class="nc">Button</span><span class="p">(</span><span class="s2">`Parent from LocalStorage </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">parentLinkObject</span><span class="p">.</span><span class="nx">code</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span> <span class="c1">// The initial value from LocalStorage will be 50, because PropB has been initialized.</span>
        <span class="p">.</span><span class="nf">onClick</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">parentLinkObject</span><span class="p">.</span><span class="nx">code</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">})</span>
      <span class="c1">// @The @Component decorated child component automatically obtains access to the CompA LocalStorage instance.</span>
      <span class="nc">Child</span><span class="p">()</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <div style="text-align:center"> <img src="../basic-concepts/images/image-basic/image25.png" /> </div> <h3 id="simple-example-of-using-localstorageprop-with-localstorage"> <a href="#simple-example-of-using-localstorageprop-with-localstorage" class="anchor-heading" aria-labelledby="simple-example-of-using-localstorageprop-with-localstorage"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Simple Example of Using @LocalStorageProp with LocalStorage </h3> <p>In this example, the <strong>CompA</strong> and <strong>Child</strong> components create local data that is one-way synchronized with the PropA attribute in the LocalStorage instance <strong>storage</strong>.</p> <ul> <li> <p>The change of <strong>this.storProp1</strong> in <strong>CompA</strong> takes effect only in <strong>CompA</strong> and is not synchronized to <strong>storage</strong>.</p> </li> <li> <p>In the <strong>Child</strong> component, the value of <strong>storageProp2</strong> bound to <strong>Text</strong> is still 47.</p> </li> </ul> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Create a new instance and initialize it with the given object.</span>
<span class="kd">let</span> <span class="nx">para</span><span class="p">:</span> <span class="nb">Record</span><span class="o">&lt;</span><span class="kr">string</span><span class="p">,</span> <span class="kr">number</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">{</span> <span class="dl">'</span><span class="s1">PropA</span><span class="dl">'</span><span class="p">:</span> <span class="mi">47</span> <span class="p">};</span>
<span class="kd">let</span> <span class="nx">storage</span><span class="p">:</span> <span class="nx">LocalStorage</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LocalStorage</span><span class="p">(</span><span class="nx">para</span><span class="p">);</span>
<span class="c1">// Make LocalStorage accessible from the @Component decorated component.</span>
<span class="p">@</span><span class="nd">Entry</span><span class="p">(</span><span class="nx">storage</span><span class="p">)</span>
<span class="p">@</span><span class="nd">Component</span>
<span class="nx">struct</span> <span class="nx">CompA</span> <span class="p">{</span>
  <span class="c1">// @LocalStorageProp creates a one-way data synchronization with the PropA attribute in LocalStorage.</span>
  <span class="p">@</span><span class="nd">LocalStorageProp</span><span class="p">(</span><span class="dl">'</span><span class="s1">PropA</span><span class="dl">'</span><span class="p">)</span> <span class="nx">storageProp1</span><span class="p">:</span> <span class="kr">number</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="nf">build</span><span class="p">()</span> <span class="p">{</span>
    <span class="nc">Column</span><span class="p">({</span> <span class="na">space</span><span class="p">:</span> <span class="mi">15</span> <span class="p">})</span> <span class="p">{</span>
      <span class="c1">// The initial value is 47. After the button is clicked, the value is incremented by 1. The change takes effect only in storageProp1 in the current component and is not synchronized to LocalStorage.</span>
      <span class="nc">Button</span><span class="p">(</span><span class="s2">`Parent from LocalStorage </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">storageProp1</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">onClick</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">storageProp1</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="p">})</span>
      <span class="nc">Child</span><span class="p">()</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="p">@</span><span class="nd">Component</span>
<span class="nx">struct</span> <span class="nx">Child</span> <span class="p">{</span>
  <span class="c1">// @LocalStorageProp creates a one-way data synchronization with the PropA attribute in LocalStorage.</span>
  <span class="p">@</span><span class="nd">LocalStorageProp</span><span class="p">(</span><span class="dl">'</span><span class="s1">PropA</span><span class="dl">'</span><span class="p">)</span> <span class="nx">storageProp2</span><span class="p">:</span> <span class="kr">number</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

  <span class="nf">build</span><span class="p">()</span> <span class="p">{</span>
    <span class="nc">Column</span><span class="p">({</span> <span class="na">space</span><span class="p">:</span> <span class="mi">15</span> <span class="p">})</span> <span class="p">{</span>
      <span class="c1">// When CompA changes, the current storageProp2 does not change, and 47 is displayed.</span>
      <span class="nc">Text</span><span class="p">(</span><span class="s2">`Parent from LocalStorage </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">storageProp2</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <div style="text-align:center"> <img src="../basic-concepts/images/image-basic/image26.png" /> </div> <h3 id="additional-information"> <a href="#additional-information" class="anchor-heading" aria-labelledby="additional-information"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Additional Information </h3> <p>For more detailed information, click the link <a href="https://github.com/eclipse-oniro-mirrors/docs/blob/OpenHarmony-4.1-Release/en/application-dev/quick-start/arkts-localstorage.md#localstorageprop">here</a></p> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
